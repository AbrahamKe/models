<?xml version='1.0' encoding='UTF-8'?>
<model xmlns="http://ccl.northwestern.edu/netlogo/netlogox/1">
  <version><![CDATA[NetLogo 6.1.0-M1]]></version>
  <previewCommands>
    <compiled><![CDATA[setup repeat 75 [ go ]]]></compiled>
  </previewCommands>
  <info><![CDATA[## WHAT IS IT?

This is like Bob's model, but stripped down and speeded up.

Seth Tisue, October 2011]]></info>
  <systemDynamics/>
  <modelInfo>
    <title/>
    <subject/>
  </modelInfo>
  <linkShapes>
    <linkShape curviness="0.0" name="default">
      <line stroke-dasharray="0.0,1.0" isVisible="false" offset="-0.2"/>
      <line stroke-dasharray="1.0,0.0" isVisible="true" offset="0.0"/>
      <line stroke-dasharray="0.0,1.0" isVisible="false" offset="0.2"/>
      <indicator editableColorIndex="0" rotatable="true" name="link direction">
        <elements>
          <line marked="true" filled="false" color="#8D8D8D" y2="180" x2="90" y1="150" x1="150"/>
          <line marked="true" filled="false" color="#8D8D8D" y2="180" x2="210" y1="150" x1="150"/>
        </elements>
      </indicator>
    </linkShape>
  </linkShapes>
  <widgets>
    <view bottom="341" right="725" top="10" left="415" frameRate="100000.0" showTickCounter="true" fontSize="10">
      <dimensions maxPycor="99" minPycor="0" maxPxcor="99" minPxcor="0" wrapInY="false" wrapInX="false" patchSize="3.0"/>
      <tickCounterLabel><![CDATA[ticks]]></tickCounterLabel>
    </view>
    <button bottom="58" right="89" top="25" left="10" ticksEnabled="false" forever="false">
      <source><![CDATA[setup]]></source>
    </button>
    <button bottom="58" right="173" top="25" left="95" ticksEnabled="true" forever="true">
      <source><![CDATA[go]]></source>
    </button>
    <plot bottom="340" right="400" top="165" left="10" ymax="2.1" ymin="2.0" xmax="1.0" xmin="0.0" legendOn="true" autoPlotOn="true">
      <display><![CDATA[Average]]></display>
      <setup/>
      <update><![CDATA[if not plot? [ stop ]]]></update>
      <pens>
        <pen inLegend="true" color="-16777216" mode="line" interval="1.0">
          <setup/>
          <update><![CDATA[plotxy ticks (total / count patches)]]></update>
          <display><![CDATA[average]]></display>
        </pen>
      </pens>
    </plot>
    <switch bottom="98" right="143" top="65" left="40" isOn="false">
      <variable><![CDATA[plot?]]></variable>
    </switch>
    <button bottom="163" right="170" top="130" left="10" ticksEnabled="false" forever="false">
      <source><![CDATA[benchmark]]></source>
      <display><![CDATA[benchmark (5000 ticks)]]></display>
    </button>
    <output fontSize="12" bottom="164" right="400" top="84" left="175"/>
    <monitor fontSize="11" bottom="60" right="285" top="15" left="200" precision="17">
      <source><![CDATA[result]]></source>
    </monitor>
  </widgets>
  <experiments/>
  <shapes>
    <vectorShape editableColorIndex="0" rotatable="true" name="default">
      <elements>
        <polygon marked="true" filled="true" color="#8D8D8D" points="150,5 40,250 150,205 260,250"/>
      </elements>
    </vectorShape>
  </shapes>
  <code><![CDATA[globals [total result]
patches-own [n]

to benchmark
  random-seed 0
  reset-timer
  setup
  repeat 5000 [ go ]
  set result timer
end

to setup
  clear-all
  ask patches [
    set n 2
    colorize
  ]
  set total 2 * count patches
  reset-ticks
end

to go
  let active-patches patch-set one-of patches
  ask active-patches [
    set n n + 1
    set total total + 1
    colorize
  ]
  while [any? active-patches] [
    let overloaded-patches active-patches with [n > 3]
    ask overloaded-patches [
      set n n - 4
      set total total - 4
      colorize
      ask neighbors4 [
        set n n + 1
        set total total + 1
        colorize
      ]
    ]
    set active-patches patch-set [neighbors4] of overloaded-patches
  ]
  tick
end

to colorize  ;; patch procedure
  ifelse n <= 3
    [ set pcolor item n [83 54 45 25] ]
    [ set pcolor red ]
end]]></code>
  <modelSettings snapToGrid="true"/>
  <hubnet/>
</model>
